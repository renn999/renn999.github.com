<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  
  <title><![CDATA[Category: about PHP | 老伯筆記]]></title>
  <link href="http://www.renn999.twbbs.org//archives/categories/about%20PHP/atom.xml" rel="self"/>
  
  <link href="http://www.renn999.twbbs.org/"/>
  <updated>2012-11-30T10:40:28+0800</updated>
  <id>http://www.renn999.twbbs.org/</id>
  <author>
    <name><![CDATA[renn999]]></name>
    <email><![CDATA[renn999@gmail.com]]></email>
  </author>
  <generator uri="http://bbk.renn999.twbbs.org/pyblogtle">pyBlogtle</generator>

  
  <entry>
    <title type="html"><![CDATA[[公告] server硬碟壞掉]]></title>
    <link href="http://www.renn999.twbbs.org/archives/886/"/>
    <updated>2011-04-24T00:00:00+0800</updated>
    <id>http://www.renn999.twbbs.org/archives/886/</id>
    <content type="html"><![CDATA[<p>老實說，有一段時間沒有更新blog了，但是久久的更新，竟然是這一件壞消息...OTZ。</p>
<p>就如標題所說的，因為有的服務是我自己寫得程式，但是我犯了一個不可饒恕的錯誤...就是我忘記備份php程式了，造成有的服務可能無時間表的停止服務，因為這個站是我緊急的跟我們一位社團學長借的空間，因為有所限制，所以說短時間內我也不大想要把剩下的服務弄上去。</p>
<p>在此公告，老伯繪師收集區停開，因為老早之前我就有打算要整個翻修內部程式碼，但是都懶得去動他，剛好趁著硬碟壞掉算是個總結吧...OTZ，但是不要擔心的是說資料庫還留著，但是程式就881了。</p>
<p>感謝大家這幾年來對此站的照顧，在這裡除了對一些編輯者至上萬分的歉意以及感謝
&lt;(<em> </em>)&gt;</p>]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Counterize II 2.14.1 IP patch(還原顯示IP功能)]]></title>
    <link href="http://www.renn999.twbbs.org/archives/468/"/>
    <updated>2009-12-15T00:00:00+0800</updated>
    <id>http://www.renn999.twbbs.org/archives/468/</id>
    <content type="html"><![CDATA[<p><a href="http://www.renn999.twbbs.org/wordpress/archives/197">前文</a>在這裡，裡面說得網站掛掉了，所以說我剛好做出了一份diff ptach出來。</p>
<p><a href="http://www.renn999.twbbs.org/wordpress/downloads/ip_patch.patch">ip_patch.patch download</a></p>
<p>使用方法：
將官方的Counterize II 2.14.1解壓縮後的資料夾和patch放在一起後，輸入</p>

<figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span></pre></td><td class='code'><pre><code><span class='line'><span class="n">patch</span> <span class="o">-</span><span class="n">p0</span> <span class="o">&lt;</span> <span class="n">ip_patch</span><span class="p">.</span><span class="n">patch</span></span>
<span class='line'></span></code></pre></td></tr></table></div></figure>


<p>如果出現</p>

<figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span></pre></td><td class='code'><pre><code><span class='line'><span class="n">patching</span> <span class="n">file</span> <span class="n">counterizeii</span><span class="o">/</span><span class="n">counterize_install</span><span class="p">.</span><span class="n">php</span></span>
<span class='line'><span class="n">patching</span> <span class="n">file</span> <span class="n">counterizeii</span><span class="o">/</span><span class="n">counterize</span><span class="p">.</span><span class="n">php</span></span>
<span class='line'></span></code></pre></td></tr></table></div></figure>


<p>表示完成了，這是在Linux底下，在windows的話可能需要GnuWin32或是其他對應的軟體。</p>]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Google AJAX Libraries API]]></title>
    <link href="http://www.renn999.twbbs.org/archives/401/"/>
    <updated>2009-10-28T00:00:00+0800</updated>
    <id>http://www.renn999.twbbs.org/archives/401/</id>
    <content type="html"><![CDATA[<p>其實今天就是在google AJAX看到的鬼東西，而且是一個非常有趣的鬼東西，依照我淺薄的接觸以為javascript Libraries只有jQuery，竟然沒想到還有這麼多的種類，</p>
<p>網站：<a href="http://code.google.com/intl/en/apis/ajaxlibs/">http://code.google.com/intl/en/apis/ajaxlibs/</a></p>
<p>其實這讓開發者真的可以非常的方便來使用一些javascript的Libraries，如果要使用jQuery的話只要</p>

<figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span></pre></td><td class='code'><pre><code><span class='line'><span class="nt">&lt;script</span> <span class="na">src=</span><span class="s">&quot;http://www.google.com/jsapi&quot;</span><span class="nt">&gt;&lt;/script&gt;</span> <span class="c">&lt;!--先include google js api--&gt;</span></span>
<span class='line'><span class="nt">&lt;script&gt;</span> </span>
<span class='line'>google.load(&quot;jquery&quot;, &quot;1.3.2&quot;);</span>
<span class='line'>google.load(&quot;jqueryui&quot;, &quot;1.7.2&quot;);</span>
<span class='line'><span class="c">&lt;!-- your js code --&gt;</span></span>
<span class='line'><span class="nt">&lt;/script&gt;</span></span>
<span class='line'></span></code></pre></td></tr></table></div></figure>


<p>真是方便的東西...XDrz</p>]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[利用php將UTF-8 -> big5 UAO沒有PATCH iconv]]></title>
    <link href="http://www.renn999.twbbs.org/archives/383/"/>
    <updated>2009-10-06T00:00:00+0800</updated>
    <id>http://www.renn999.twbbs.org/archives/383/</id>
    <content type="html"><![CDATA[<p>最近因為嘗試要轉換一些HTML-&gt;BBS的文章會發生的問題，所以說就寫了一個這樣的程式，因為我完全不想要動到iconv的PATCH，所以說就先利用ZTerm src中的BIG5表格下去做轉換，結果還不錯。</p>
<p>(修正了幾個bug 091006 21：00)</p>

<figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'> 1</span>
<span class='line-number'> 2</span>
<span class='line-number'> 3</span>
<span class='line-number'> 4</span>
<span class='line-number'> 5</span>
<span class='line-number'> 6</span>
<span class='line-number'> 7</span>
<span class='line-number'> 8</span>
<span class='line-number'> 9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span></pre></td><td class='code'><pre><code><span class='line'><span class="cp">&lt;?php</span></span>
<span class='line'><span class="cm">/*  </span></span>
<span class='line'><span class="cm"> *  This php is using GNU General Public License v2.0</span></span>
<span class='line'><span class="cm"> *  renn999&lt;AT&gt;ccns.ncku.edu.tw</span></span>
<span class='line'><span class="cm"> *  http://renn999.twbbs.org</span></span>
<span class='line'><span class="cm"> *</span></span>
<span class='line'><span class="cm"> *  USAGE:ucs2big5( $str );</span></span>
<span class='line'><span class="cm"> *  </span></span>
<span class='line'><span class="cm"> *  Big5 table(big5.txt)</span></span>
<span class='line'><span class="cm"> *  using from Ztrem</span></span>
<span class='line'><span class="cm"> *  http://zhouer.org/ZTerm/</span></span>
<span class='line'><span class="cm"> */</span></span>
<span class='line'></span>
<span class='line'><span class="k">function</span> <span class="nf">ucs2big5</span><span class="p">(</span><span class="nv">$ucs_str</span><span class="p">)</span> <span class="p">{</span></span>
<span class='line'>    <span class="nv">$fp</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span> <span class="s1">&#39;big5.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span> <span class="p">);</span></span>
<span class='line'>    <span class="nv">$len</span> <span class="o">=</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$ucs_str</span><span class="p">);</span></span>
<span class='line'>    <span class="nb">unset</span><span class="p">(</span><span class="nv">$big5_str</span><span class="p">);</span></span>
<span class='line'></span>
<span class='line'>    <span class="nv">$x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span></span>
<span class='line'>    <span class="k">for</span><span class="p">(</span> <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$len</span> <span class="p">;</span> <span class="nv">$i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span></span>
<span class='line'>        <span class="nv">$b1</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="nv">$ucs_str</span><span class="p">[</span><span class="nv">$i</span><span class="p">]);</span></span>
<span class='line'>        <span class="k">if</span><span class="p">(</span> <span class="nv">$b1</span> <span class="o">&lt;</span> <span class="mh">0x80</span> <span class="p">)</span> <span class="p">{</span></span>
<span class='line'>            <span class="nv">$big5_str</span><span class="p">[</span><span class="nv">$x</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="nv">$b1</span><span class="p">);</span></span>
<span class='line'>        <span class="p">}</span></span>
<span class='line'>        <span class="k">elseif</span><span class="p">(</span> <span class="nv">$b1</span> <span class="o">&gt;=</span> <span class="mi">224</span> <span class="p">)</span> <span class="p">{</span></span>
<span class='line'>            <span class="c1">#3code UTF-8</span></span>
<span class='line'>            <span class="nv">$b1</span> <span class="o">-=</span> <span class="mi">224</span><span class="p">;</span></span>
<span class='line'>            <span class="nv">$b2</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="nv">$ucs_str</span><span class="p">[</span><span class="o">++</span><span class="nv">$i</span><span class="p">])</span> <span class="o">-</span> <span class="mi">128</span><span class="p">;</span></span>
<span class='line'>            <span class="nv">$b3</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="nv">$ucs_str</span><span class="p">[</span><span class="o">++</span><span class="nv">$i</span><span class="p">])</span> <span class="o">-</span> <span class="mi">256</span><span class="p">;</span></span>
<span class='line'>            <span class="nv">$ucs_code</span> <span class="o">=</span> <span class="nv">$b1</span> <span class="o">*</span> <span class="mi">4096</span> <span class="o">+</span> <span class="nv">$b2</span> <span class="o">*</span> <span class="mi">64</span> <span class="o">+</span> <span class="nv">$b3</span><span class="p">;</span></span>
<span class='line'>            <span class="nb">fseek</span><span class="p">(</span> <span class="nv">$fp</span><span class="p">,</span> <span class="nv">$ucs_code</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span></span>
<span class='line'>            <span class="nv">$big5_code</span> <span class="o">=</span> <span class="nb">fread</span><span class="p">(</span> <span class="nv">$fp</span><span class="p">,</span> <span class="mi">2</span> <span class="p">);</span></span>
<span class='line'>            <span class="nv">$big5_str</span><span class="p">[</span><span class="nv">$x</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$big5_code</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span></span>
<span class='line'>            <span class="nv">$big5_str</span><span class="p">[</span><span class="nv">$x</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$big5_code</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span></span>
<span class='line'>        <span class="p">}</span></span>
<span class='line'>        <span class="k">elseif</span><span class="p">(</span> <span class="nv">$b1</span> <span class="o">&gt;=</span> <span class="mi">192</span> <span class="p">)</span> <span class="p">{</span></span>
<span class='line'>            <span class="c1">#2code UTF-8</span></span>
<span class='line'>            <span class="nv">$b1</span> <span class="o">-=</span> <span class="mi">192</span><span class="p">;</span></span>
<span class='line'>            <span class="nv">$b2</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="nv">$ucs_str</span><span class="p">[</span><span class="o">++</span><span class="nv">$i</span><span class="p">])</span> <span class="o">-</span> <span class="mi">256</span><span class="p">;</span></span>
<span class='line'>            <span class="nv">$ucs_code</span> <span class="o">=</span> <span class="nv">$b1</span> <span class="o">*</span> <span class="mi">64</span> <span class="o">+</span> <span class="nv">$b2</span> <span class="p">;</span></span>
<span class='line'>            <span class="nb">fseek</span><span class="p">(</span> <span class="nv">$fp</span><span class="p">,</span> <span class="nv">$ucs_code</span> <span class="o">*</span> <span class="mi">2</span> <span class="p">);</span></span>
<span class='line'>            <span class="nv">$big5_code</span> <span class="o">=</span> <span class="nb">fread</span><span class="p">(</span> <span class="nv">$fp</span><span class="p">,</span> <span class="mi">2</span> <span class="p">);</span></span>
<span class='line'>            <span class="nv">$big5_str</span><span class="p">[</span><span class="nv">$x</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$big5_code</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span></span>
<span class='line'>            <span class="nv">$big5_str</span><span class="p">[</span><span class="nv">$x</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$big5_code</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span></span>
<span class='line'>        <span class="p">}</span><span class="k">else</span><span class="p">{</span></span>
<span class='line'>            <span class="nv">$big5_str</span><span class="p">[</span><span class="nv">$x</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;?&#39;</span><span class="p">;</span></span>
<span class='line'>        <span class="p">}</span></span>
<span class='line'>    <span class="p">}</span></span>
<span class='line'></span>
<span class='line'>    <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span></span>
<span class='line'>    <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$big5_str</span><span class="p">))</span> <span class="p">{</span></span>
<span class='line'>        <span class="k">return</span> <span class="nb">join</span><span class="p">(</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nv">$big5_str</span><span class="p">);</span></span>
<span class='line'>    <span class="p">}</span></span>
<span class='line'><span class="p">}</span></span>
<span class='line'><span class="cp">?&gt;</span><span class="x"></span></span>
<span class='line'></span></code></pre></td></tr></table></div></figure>


<p>至於BIG5.txt可以到<a href="http://zterm.googlecode.com/svn/trunk/org/zhouer/utils/conv/">http://zterm.googlecode.com/svn/trunk/org/zhouer/utils/conv/</a>中去下載 這裡就不附上了</p>]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[PHP備份Pixiv的bookmark(お気に入りユーザー)修正版]]></title>
    <link href="http://www.renn999.twbbs.org/archives/371/"/>
    <updated>2009-09-30T00:00:00+0800</updated>
    <id>http://www.renn999.twbbs.org/archives/371/</id>
    <content type="html"><![CDATA[<p>基本上之前的程式一定不能用了，但是phpQuery在備份的時候都會吐出亂碼來，可能是內部的編碼偵測出了問題。</p>
<p>所以基本上我就用了simple html dom但是這個有一個缺點，就是需要比較多的記憶體空間。
(這是Memory Leaks的問題已經解決)</p>
<p>以下為修改完的程式碼。</p>

<figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'> 1</span>
<span class='line-number'> 2</span>
<span class='line-number'> 3</span>
<span class='line-number'> 4</span>
<span class='line-number'> 5</span>
<span class='line-number'> 6</span>
<span class='line-number'> 7</span>
<span class='line-number'> 8</span>
<span class='line-number'> 9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span></pre></td><td class='code'><pre><code><span class='line'><span class="cp">&lt;?php</span></span>
<span class='line'>    <span class="k">require</span> <span class="s1">&#39;simplehtmldom/simple_html_dom.php&#39;</span><span class="p">;</span></span>
<span class='line'></span>
<span class='line'>    <span class="nv">$loginurl</span><span class="o">=</span><span class="s1">&#39;http://www.pixiv.net/index.php&#39;</span><span class="p">;</span></span>
<span class='line'>    <span class="nv">$pixiv_id</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span></span>
<span class='line'>    <span class="nv">$password</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">;</span></span>
<span class='line'></span>
<span class='line'>    <span class="nv">$curl</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span></span>
<span class='line'>    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_HEADER</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span></span>
<span class='line'>    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_USERAGENT</span><span class="p">,</span><span class="s1">&#39;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; (R1 1.5); InfoPath.2)&#39;</span><span class="p">);</span></span>
<span class='line'>    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_FOLLOWLOCATION</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span></span>
<span class='line'>    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span></span>
<span class='line'>    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_COOKIEJAR</span><span class="p">,</span> <span class="s1">&#39;cookie.txt&#39;</span><span class="p">);</span></span>
<span class='line'>    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_COOKIEFILE</span><span class="p">,</span> <span class="s1">&#39;cookie.txt&#39;</span><span class="p">);</span></span>
<span class='line'>    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_POST</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span></span>
<span class='line'>    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_COOKIESESSION</span><span class="p">,</span><span class="k">true</span><span class="p">);</span></span>
<span class='line'>    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$loginurl</span><span class="p">);</span></span>
<span class='line'>    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_POSTFIELDS</span><span class="p">,</span> <span class="s1">&#39;mode=login&amp;pixiv_id=&#39;</span><span class="o">.</span><span class="nv">$pixiv_id</span><span class="o">.</span><span class="s1">&#39;&amp;pass=&#39;</span><span class="o">.</span><span class="nv">$password</span> <span class="p">);</span></span>
<span class='line'>    <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$curl</span><span class="p">);</span></span>
<span class='line'></span>
<span class='line'>    <span class="nv">$p</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span></span>
<span class='line'>    <span class="nv">$bookmark_rest</span><span class="o">=</span><span class="s1">&#39;show&#39;</span><span class="p">;</span><span class="c1">//show</span></span>
<span class='line'>    <span class="k">do</span><span class="p">{</span></span>
<span class='line'>        <span class="nv">$url</span><span class="o">=</span><span class="s1">&#39;http://www.pixiv.net/bookmark.php?type=user&amp;rest=&#39;</span><span class="o">.</span><span class="nv">$bookmark_rest</span><span class="o">.</span><span class="s1">&#39;&amp;p=&#39;</span><span class="o">.</span><span class="nv">$p</span><span class="p">;</span></span>
<span class='line'>        <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$curl</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span></span>
<span class='line'>        <span class="nv">$profile</span><span class="o">=</span><span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$curl</span><span class="p">);</span></span>
<span class='line'>        <span class="nv">$dom1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">simple_html_dom</span><span class="p">();</span></span>
<span class='line'>        <span class="nv">$dom1</span> <span class="o">=</span> <span class="nx">str_get_html</span><span class="p">(</span><span class="nv">$profile</span><span class="p">);</span></span>
<span class='line'></span>
<span class='line'>        <span class="nv">$test</span><span class="o">=</span><span class="nv">$dom1</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">&#39;div#content2 div[align=&quot;right&quot;]&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">plaintext</span><span class="p">;</span></span>
<span class='line'></span>
<span class='line'>        <span class="nb">preg_match</span><span class="p">(</span><span class="s1">&#39;/次の(.*?)件/&#39;</span><span class="p">,</span><span class="nv">$test</span><span class="p">,</span><span class="nv">$match</span><span class="p">);</span></span>
<span class='line'></span>
<span class='line'>        <span class="nv">$title2</span> <span class="o">=</span> <span class="nv">$dom1</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">&#39;div#content2 form#f div[style=&quot;width:140px;height:130px;float:left;text-align:center;&quot;]&#39;</span><span class="p">);</span></span>
<span class='line'></span>
<span class='line'>        <span class="k">foreach</span><span class="p">(</span><span class="nv">$title2</span> <span class="k">as</span> <span class="nv">$illsthtml</span><span class="p">){</span></span>
<span class='line'>        <span class="nv">$illst</span> <span class="o">=</span> <span class="nv">$illsthtml</span><span class="o">-&gt;</span><span class="na">outertext</span><span class="p">;</span></span>
<span class='line'>        <span class="nv">$illst</span><span class="o">=</span><span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;/&lt;div(.*?)&quot;&gt;&lt;input(.*?)&gt;&lt;\/div&gt;/&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="nv">$illst</span><span class="p">);</span></span>
<span class='line'>        <span class="nv">$illst</span><span class="o">=</span><span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;/\n/&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span><span class="nv">$illst</span><span class="p">);</span></span>
<span class='line'>        <span class="nv">$illst</span><span class="o">=</span><span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;/&lt;img(.*?)&gt;/&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span><span class="nv">$illst</span><span class="p">);</span></span>
<span class='line'>        <span class="nb">preg_match_all</span><span class="p">(</span><span class="s1">&#39;/&lt;a href=&quot;member.php\?id=(.*?)&quot;&gt;&lt;\/a&gt;&lt;div style=\&quot;padding-top:5px;\&quot;&gt;(.*?)&lt;\/div&gt;(&lt;a href=&quot;jump.php\?(.*?)&quot; target=&quot;_blank&quot;&gt;&lt;\/a&gt;)?/&#39;</span><span class="p">,</span> <span class="nv">$illst</span><span class="p">,</span><span class="nv">$match2</span><span class="p">,</span><span class="nx">PREG_SET_ORDER</span><span class="p">);</span></span>
<span class='line'>            <span class="k">foreach</span> <span class="p">(</span><span class="nv">$match2</span> <span class="k">as</span> <span class="nv">$val</span><span class="p">)</span> <span class="p">{</span></span>
<span class='line'>                <span class="k">echo</span> <span class="s1">&#39;http://www.pixiv.net/member.php?id=&#39;</span><span class="o">.</span><span class="nv">$val</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39; - &#39;</span><span class="o">.</span><span class="nv">$val</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span></span>
<span class='line'>                <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$val</span><span class="p">[</span><span class="mi">4</span><span class="p">])){</span><span class="k">echo</span> <span class="s1">&#39; - &#39;</span><span class="o">.</span><span class="nv">$val</span><span class="p">[</span><span class="mi">4</span><span class="p">];}</span></span>
<span class='line'>                <span class="k">echo</span> <span class="s2">&quot;&lt;br /&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span></span>
<span class='line'>            <span class="p">}</span></span>
<span class='line'>        <span class="p">}</span></span>
<span class='line'>        <span class="nv">$dom1</span><span class="o">-&gt;</span><span class="na">__destruct</span><span class="p">();</span><span class="c1">//解決Memory Leaks的問題</span></span>
<span class='line'>        <span class="nb">unset</span><span class="p">(</span><span class="nv">$profile</span><span class="p">,</span><span class="nv">$dom1</span><span class="p">,</span><span class="nv">$test</span><span class="p">);</span></span>
<span class='line'>        <span class="nv">$p</span><span class="o">++</span><span class="p">;</span></span>
<span class='line'>    <span class="p">}</span><span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$match</span><span class="p">));</span></span>
<span class='line'></span>
<span class='line'>    <span class="nb">curl_close</span><span class="p">(</span><span class="nv">$curl</span><span class="p">);</span></span>
<span class='line'><span class="cp">?&gt;</span></span>
<span class='line'></span></code></pre></td></tr></table></div></figure>]]></content>
  </entry>
  
</feed>